# å›¾åƒç®—æ³•


## ä¸€ã€opencvåŸºç¡€çŸ¥è¯†

## äºŒã€opencvåŸºç¡€è¿ç®—


## ä¸‰ã€opencvç‰¹å¾

### 3.1 å›¾åƒå½¢æ€å­¦

å½¢æ€å­¦ä¸€èˆ¬æ˜¯ä½¿ç”¨äºŒå€¼å›¾åƒ,è¿›è¡Œè¾¹ç•Œæå–,éª¨æ¶æå–,å­”æ´å¡«å……,è§’ç‚¹æå–,å›¾åƒé‡å»ºã€‚åŸºæœ¬çš„ç®—æ³•:è†¨èƒ€è…èš€,å¼€æ“ä½œ,é—­æ“ä½œ,å‡»ä¸­å‡»ä¸ä¸­å˜æ¢å‡ ç§ç®—æ³•è¿›è¡Œç»„åˆ,å°±å¯ä»¥å®ç°ä¸€äº›éå¸¸å¤æ‚çš„åŠŸèƒ½,è€Œä¸”é€»è¾‘ä¸¥å¯†ã€‚

æ•°å­¦å½¢æ€å­¦æ˜¯ä¸€é—¨å»ºç«‹åœ¨é›†è®ºåŸºç¡€ä¸Šçš„å­¦ç§‘,æ˜¯å‡ ä½•å½¢æ€å­¦åˆ†æå’Œæè¿°çš„æœ‰åŠ›å·¥å…·ã€‚æ•°å­¦å½¢æ€å­¦çš„å†å²å¯å›æº¯åˆ°19ä¸–çºªã€‚1964å¹´æ³•å›½çš„Matheronå’ŒSerraåœ¨ç§¯åˆ†å‡ ä½•çš„ç ”ç©¶æˆæœä¸Š,å°†æ•°å­¦å½¢æ€å­¦å¼•å…¥å›¾åƒå¤„ç†é¢†åŸŸ,å¹¶ç ”åˆ¶äº†åŸºäºæ•°å­¦å½¢æ€å­¦çš„å›¾åƒå¤„ç†ç³»ç»Ÿã€‚1982å¹´å‡ºç‰ˆçš„ä¸“è‘—ã€ŠImage Analysis and Mathematical Morphologyã€‹æ˜¯æ•°å­¦å½¢æ€å­¦å‘å±•çš„é‡è¦é‡Œç¨‹ç¢‘,è¡¨æ˜æ•°å­¦å½¢æ€å­¦åœ¨ç†è®ºä¸Šè¶‹äºå®Œå¤‡åŠåº”ç”¨ä¸Šä¸æ–­æ·±å…¥ã€‚æ•°å­¦å½¢æ€å­¦è“¬å‹ƒå‘å±•,ç”±äºå…¶å¹¶è¡Œå¿«é€Ÿ,æ˜“äºç¡¬ä»¶å®ç°,å·²å¼•èµ·äº†äººä»¬çš„å¹¿æ³›å…³æ³¨ã€‚ç›®å‰,æ•°å­¦å½¢æ€å­¦å·²åœ¨è®¡ç®—æœºè§†è§‰ã€ä¿¡å·å¤„ç†ä¸å›¾åƒåˆ†æã€æ¨¡å¼è¯†åˆ«ã€è®¡ç®—æ–¹æ³•ä¸æ•°æ®å¤„ç†ç­‰æ–¹é¢å¾—åˆ°äº†æä¸ºå¹¿æ³›çš„åº”ç”¨ã€‚

æ•°å­¦å½¢æ€å­¦å¯ä»¥ç”¨æ¥è§£å†³æŠ‘åˆ¶å™ªå£°ã€ç‰¹å¾æå–ã€è¾¹ç¼˜æ£€æµ‹ã€å›¾åƒåˆ†å‰²ã€å½¢çŠ¶è¯†åˆ«ã€çº¹ç†åˆ†æã€å›¾åƒæ¢å¤ä¸é‡å»ºã€å›¾åƒå‹ç¼©ç­‰å›¾åƒå¤„ç†é—®é¢˜ã€‚

* **æ•°å­¦å½¢æ€å­¦çš„å®šä¹‰å’Œåˆ†ç±»**

æ•°å­¦å½¢æ€å­¦æ˜¯ä»¥å½¢æ€ç»“æ„å…ƒç´ ä¸ºåŸºç¡€å¯¹å›¾åƒè¿›è¡Œåˆ†æçš„æ•°å­¦å·¥å…·ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ç”¨å…·æœ‰ä¸€å®šå½¢æ€çš„ç»“æ„å…ƒç´ å»åº¦é‡å’Œæå–å›¾åƒä¸­çš„å¯¹åº”å½¢çŠ¶ä»¥è¾¾åˆ°å¯¹å›¾åƒåˆ†æå’Œè¯†åˆ«çš„ç›®çš„ã€‚æ•°å­¦å½¢æ€å­¦çš„åº”ç”¨å¯ä»¥ç®€åŒ–å›¾åƒæ•°æ®,ä¿æŒå®ƒä»¬åŸºæœ¬çš„å½¢çŠ¶ç‰¹å¾,å¹¶é™¤å»ä¸ç›¸å¹²çš„ç»“æ„ã€‚æ•°å­¦å½¢æ€å­¦çš„åŸºæœ¬è¿ç®—æœ‰4ä¸ª:è†¨èƒ€ã€è…èš€ã€å¼€å¯å’Œé—­åˆã€‚å®ƒä»¬åœ¨äºŒå€¼å›¾åƒä¸­å’Œç°åº¦å›¾åƒä¸­å„æœ‰ç‰¹ç‚¹ã€‚åŸºäºè¿™äº›åŸºæœ¬è¿ç®—è¿˜å¯ä»¥æ¨å¯¼å’Œç»„åˆæˆå„ç§æ•°å­¦å½¢æ€å­¦å®ç”¨ç®—æ³•ã€‚

**åŸºç¡€çŸ¥è¯†**

æ•°å­¦å½¢æ€å­¦ä¸­çš„é›†åˆè¡¨ç¤ºå›¾åƒä¸­çš„å¯¹è±¡ã€‚ä¾‹å¦‚,åœ¨äºŒå€¼å›¾åƒä¸­,æ‰€æœ‰ç™½è‰²åƒç´ çš„é›†åˆæ˜¯è¯¥å›¾åƒçš„ä¸€ä¸ªå®Œæ•´çš„å½¢æ€å­¦æè¿°ã€‚é—®é¢˜é›†åˆæ˜¯äºŒç»´æ•´æ•°ç©ºé—´$Z^2$çš„å…ƒç´ ã€‚

åŸºæœ¬é›†åˆå®šä¹‰:

> * é›†åˆ:ç”¨å¤§å†™å­—æ¯è¡¨ç¤º,ç©ºé›†è®°ä¸º$\empty$
> * å…ƒç´ :ç”¨å°å†™å­—æ¯è¡¨ç¤º
> * å­é›†ï¼š A âŠ† B
> * å¹¶é›†ï¼š C = Aâ‹ƒB
> * äº¤é›†ï¼š D = Aâ‹‚B
> * è¡¥é›†ï¼šğ´
> * $A^c$= {ğ‘¥|ğ‘¥ âˆ‰ ğ´}
> * ä½ç§»ï¼š(ğ´)à¯«= {ğ‘¦|ğ‘¦ = ğ‘ + ğ‘¥, ğ‘ âˆˆ ğ´}
> * æ˜ åƒï¼šğ´áˆ˜ = {ğ‘¥|ğ‘¥ = âˆ’ğ‘, ğ‘ âˆˆ ğ´}
> * å·®é›†ï¼šA âˆ’ B = x x âˆˆ ğ´, ğ‘¥ âˆ‰ ğµ = Aâ‹‚ğµà¯–

**äºŒå€¼å½¢æ€å­¦**

æ•°å­¦å½¢æ€å­¦ä¸­äºŒå€¼å›¾åƒçš„å½¢æ€å˜æ¢æ˜¯ä¸€ç§é’ˆå¯¹é›†åˆçš„å¤„ç†è¿‡ç¨‹ã€‚å…¶å½¢æ€ç®—å­çš„å®è´¨æ˜¯è¡¨è¾¾ç‰©ä½“æˆ–å½¢çŠ¶çš„é›†åˆä¸ç»“æ„å…ƒç´ é—´çš„ç›¸äº’ä½œç”¨,ç»“æ„å…ƒç´ çš„å½¢çŠ¶å°±å†³å®šäº†è¿™ç§è¿ç®—æ‰€æå–çš„ä¿¡å·çš„å½¢çŠ¶ä¿¡æ¯ã€‚å½¢æ€å­¦å›¾åƒå¤„ç†æ˜¯åœ¨å›¾åƒä¸­ç§»åŠ¨ä¸€ä¸ªç»“æ„å…ƒç´ ,ç„¶åå°†ç»“æ„å…ƒç´ ä¸ä¸‹é¢çš„äºŒå€¼å›¾åƒè¿›è¡Œäº¤ã€å¹¶ç­‰é›†åˆè¿ç®—ã€‚åŸºæœ¬çš„å½¢æ€è¿ç®—æ˜¯è…èš€å’Œè†¨èƒ€ã€‚

åœ¨å½¢æ€å­¦ä¸­,ç»“æ„å…ƒç´ æ˜¯æœ€é‡è¦æœ€åŸºæœ¬çš„æ¦‚å¿µã€‚ç»“æ„å…ƒç´ åœ¨å½¢æ€å˜æ¢ä¸­çš„ä½œç”¨ç›¸å½“äºä¿¡å·å¤„ç†ä¸­çš„â€œæ»¤æ³¢çª—å£â€ã€‚ç”¨$B(x)$ä»£è¡¨ç»“æ„å…ƒç´ ,å¯¹å·¥ä½œç©ºé—´Eä¸­çš„æ¯ä¸€ç‚¹$x$,è…èš€å’Œè†¨èƒ€çš„å®šä¹‰ä¸º:

$$
\begin{aligned}
    & \text{è†¨èƒ€:}X=E\odot B = \{x;B(x)\subset E\}  \\
    & \text{è…èš€:}Y=E\oplus B= \{y:B(y)\cap E\neq \varnothing\}
\end{aligned}
$$

ç”¨$B(x)$å¯¹$E$è¿›è¡Œè…èš€çš„ç»“æœå°±æ˜¯æŠŠç»“æ„å…ƒç´ $B$å¹³ç§»åä½¿$B$åŒ…å«äº$E$çš„æ‰€æœ‰ç‚¹æ„æˆçš„é›†åˆã€‚ç”¨$B(x)$å¯¹Eè¿›è¡Œè†¨èƒ€çš„ç»“æœå°±æ˜¯æŠŠç»“æ„å…ƒç´ Bå¹³ç§»åä½¿$B$ä¸$E$çš„äº¤é›†éç©ºçš„ç‚¹æ„æˆçš„é›†åˆã€‚å…ˆè…èš€åè†¨èƒ€çš„è¿‡ç¨‹ç§°ä¸ºå¼€è¿ç®—ã€‚å®ƒå…·æœ‰æ¶ˆé™¤ç»†å°ç‰©ä½“,åœ¨çº¤ç»†å¤„åˆ†ç¦»ç‰©ä½“å’Œå¹³æ»‘è¾ƒå¤§ç‰©ä½“è¾¹ç•Œçš„ä½œç”¨ã€‚å…ˆè†¨èƒ€åè…èš€çš„è¿‡ç¨‹ç§°ä¸ºé—­è¿ç®—ã€‚å®ƒå…·æœ‰å¡«å……ç‰©ä½“å†…ç»†å°ç©ºæ´,è¿æ¥é‚»è¿‘ç‰©ä½“å’Œå¹³æ»‘è¾¹ç•Œçš„ä½œç”¨ã€‚

å¯è§,äºŒå€¼å½¢æ€è†¨èƒ€ä¸è…èš€å¯è½¬åŒ–ä¸ºé›†åˆçš„é€»è¾‘è¿ç®—,ç®—æ³•ç®€å•,é€‚äºå¹¶è¡Œå¤„ç†,ä¸”æ˜“äºç¡¬ä»¶å®ç°,é€‚äºå¯¹äºŒå€¼å›¾åƒè¿›è¡Œå›¾åƒåˆ†å‰²ã€ç»†åŒ–ã€æŠ½å–éª¨æ¶ã€è¾¹ç¼˜æå–ã€å½¢çŠ¶åˆ†æã€‚ä½†æ˜¯,åœ¨ä¸åŒçš„åº”ç”¨åœºåˆ,ç»“æ„å…ƒç´ çš„é€‰æ‹©åŠå…¶ç›¸åº”çš„å¤„ç†ç®—æ³•æ˜¯ä¸ä¸€æ ·çš„,å¯¹ä¸åŒçš„ç›®æ ‡å›¾åƒéœ€è®¾è®¡ä¸åŒçš„ç»“æ„å…ƒç´ å’Œä¸åŒçš„å¤„ç†ç®—æ³•ã€‚ç»“æ„å…ƒç´ çš„å¤§å°ã€å½¢çŠ¶é€‰æ‹©åˆé€‚ä¸å¦,å°†ç›´æ¥å½±å“å›¾åƒçš„å½¢æ€è¿ç®—ç»“æœã€‚å› æ­¤,å¾ˆå¤šå­¦è€…ç»“åˆè‡ªå·±çš„åº”ç”¨å®é™…,æå‡ºäº†ä¸€ç³»åˆ—çš„æ”¹è¿›ç®—æ³•ã€‚å¦‚æ¢å‹‡æå‡ºçš„ç”¨å¤šæ–¹ä½å½¢æ€å­¦ç»“æ„å…ƒç´ è¿›è¡Œè¾¹ç¼˜æ£€æµ‹ç®—æ³•æ—¢å…·æœ‰è¾ƒå¥½çš„è¾¹ç¼˜å®šä½èƒ½åŠ›,åˆå…·æœ‰å¾ˆå¥½çš„å™ªå£°å¹³æ»‘èƒ½åŠ›ã€‚è®¸è¶…æå‡ºçš„ä»¥æœ€çŸ­çº¿æ®µç»“æ„å…ƒç´ æ„é€ å‡†åœ†ç»“æ„å…ƒç´ æˆ–åºåˆ—ç»“æ„å…ƒç´ ç”Ÿæˆå‡†åœ†ç»“æ„å…ƒç´ ç›¸ç»“åˆçš„è®¾è®¡æ–¹æ³•,ç”¨äºéª¨æ¶çš„æå–,å¯å¤§å¤§å‡å°‘å½¢æ€è¿ç®—çš„è®¡ç®—é‡,å¹¶å¯åŒæ—¶æ»¡è¶³å°ºåº¦ã€å¹³ç§»åŠæ—‹è½¬ç›¸å®¹æ€§,é€‚äºå¯¹å½¢çŠ¶è¿›è¡Œåˆ†æå’Œæè¿°ã€‚

> * **è…èš€**
> 
> ![](http://img-blog.csdn.net/20161110154259230)
> 
> * **è†¨èƒ€**
> 
> ![](http://img-blog.csdn.net/20161110152936118)
> 
>  **å¼€è¿ç®—:å…ˆè…èš€åè†¨èƒ€,å…·æœ‰æ¶ˆé™¤ç»†å°ç‰©ä½“,åœ¨çº¤ç»†å¤„åˆ†ç¦»ç‰©ä½“å’Œå¹³æ»‘è¾ƒå¤§ç‰©ä½“è¾¹ç•Œçš„ä½œç”¨**
> 
> ![](http://img-blog.csdn.net/20161110160457655)
>
> * **é—­è¿ç®—:å…ˆè†¨èƒ€åè…èš€,å…·æœ‰å¡«å……ç‰©ä½“å†…ç»†å°ç©ºæ´,è¿æ¥é‚»è¿‘ç‰©ä½“å’Œå¹³æ»‘è¾¹ç•Œçš„ä½œç”¨**
>
> ![](http://img-blog.csdn.net/20161110161825931)

**ç°åº¦æ•°å­¦å½¢æ€å­¦**

äºŒå€¼æ•°å­¦å½¢æ€å­¦å¯æ–¹ä¾¿åœ°æ¨å¹¿åˆ°ç°åº¦å›¾åƒç©ºé—´ã€‚åªæ˜¯ç°åº¦æ•°å­¦å½¢æ€å­¦çš„è¿ç®—å¯¹è±¡ä¸æ˜¯é›†åˆ,è€Œæ˜¯å›¾åƒå‡½æ•°ã€‚ä»¥ä¸‹è®¾$f(x,y)$æ˜¯è¾“å…¥å›¾åƒ,$b(x,y)$æ˜¯ç»“æ„å…ƒç´ ã€‚ç”¨ç»“æ„å…ƒç´ $b$å¯¹è¾“å…¥å›¾åƒ$y$è¿›è¡Œè†¨èƒ€å’Œè…èš€è¿ç®—åˆ†åˆ«å®šä¹‰ä¸º:

$$
\begin{aligned}
    & (f\oplus b)(s,t)=\max \{f(s-x,t-y) + b(x,y) |(s-x,t-y)\in D_f,(x,y)\in D_b\} \\
    & (f\odot b)(s,t)=\min \{f(s+x,t+y) + b(x,y) |(s-x,t-y)\in D_f,(x,y)\in D_b\}
\end{aligned}
$$

å¯¹ç°åº¦å›¾åƒçš„è†¨èƒ€(æˆ–è…èš€)æ“ä½œæœ‰ä¸¤ç±»æ•ˆæœ:

> * å¦‚æœç»“æ„å…ƒç´ çš„å€¼éƒ½ä¸ºæ­£çš„,åˆ™è¾“å‡ºå›¾åƒä¼šæ¯”è¾“å…¥å›¾åƒäº®(æˆ–æš—);
> * æ ¹æ®è¾“å…¥å›¾åƒä¸­æš—(æˆ–äº®)ç»†èŠ‚çš„ç°åº¦å€¼ä»¥åŠå®ƒä»¬çš„å½¢çŠ¶ç›¸å¯¹äºç»“æ„å…ƒç´ çš„å…³ç³»,å®ƒä»¬åœ¨è¿ç®—ä¸­æˆ–è¢«æ¶ˆå‡æˆ–è¢«é™¤æ‰ã€‚ç°åº¦æ•°å­¦å½¢æ€å­¦ä¸­å¼€å¯å’Œé—­åˆè¿ç®—çš„å®šä¹‰ä¸åœ¨äºŒå€¼æ•°å­¦å½¢æ€å­¦ä¸­çš„å®šä¹‰ä¸€è‡´ã€‚ç”¨$b$å¯¹fè¿›è¡Œå¼€å¯å’Œé—­åˆè¿ç®—çš„å®šä¹‰ä¸º:

$$
\begin{aligned}
    & f*b=(f\odot b)\oplus b \\
    & f*b=(f\oplus b)\odot b
\end{aligned}
$$

**æ¨¡ç³Šæ•°å­¦å½¢æ€å­¦**

å°†æ¨¡ç³Šé›†åˆç†è®ºç”¨äºæ•°å­¦å½¢æ€å­¦å°±å½¢æˆäº†æ¨¡ç³Šå½¢æ€å­¦ã€‚æ¨¡ç³Šç®—å­çš„å®šä¹‰ä¸åŒ,ç›¸åº”çš„æ¨¡ç³Šå½¢æ€è¿ç®—çš„å®šä¹‰ä¹Ÿä¸ç›¸åŒã€‚åœ¨æ­¤,é€‰ç”¨Shinbaçš„å®šä¹‰æ–¹æ³•ã€‚æ¨¡ç³Šæ€§ç”±ç»“æ„å…ƒç´ å¯¹åŸå›¾åƒçš„é€‚åº”ç¨‹åº¦æ¥ç¡®å®šã€‚ç”¨æœ‰ç•Œæ”¯æ’‘çš„æ¨¡ç³Šç»“æ„å…ƒç´ å¯¹æ¨¡ç³Šå›¾åƒçš„è…èš€å’Œè†¨èƒ€è¿ç®—æŒ‰å®ƒä»¬çš„éš¶å±å‡½æ•°å®šä¹‰ä¸º:

$$
\begin{aligned}
    & \mu_{A\odot B} = \min_{y\in B}[\min[1,1+\mu_A(x+y)-\mu_B(y)]] = \min[1,\min_{y\in B}[1+\mu_A(x+y)-\mu_B(y)]] \\
    & \mu_{A\odot B} = \max_{y\in B}[\max[0,\mu_A(x-y)+\mu_B(y)-1]] = \max[0,\max_{y\in B}[\mu_A(x-y)+\mu_B(y)-1]]
\end{aligned}
$$

å…¶ä¸­,$x,y\in Z^2$ä»£è¡¨ç©ºé—´åæ ‡,$u_a,u_b$åˆ†åˆ«ä»£è¡¨å›¾åƒå’Œç»“æ„å…ƒç´ çš„éš¶å±å‡½æ•°ã€‚ä»ä¸Šå¼çš„ç»“æœå¯çŸ¥,ç»æ¨¡ç³Šå½¢æ€è…èš€è†¨èƒ€è¿ç®—åçš„éš¶å±å‡½æ•°å‡è½åœ¨[0,1]çš„åŒºé—´å†…ã€‚æ¨¡ç³Šå½¢æ€å­¦æ˜¯ä¼ ç»Ÿæ•°å­¦å½¢æ€å­¦ä»äºŒå€¼é€»è¾‘å‘æ¨¡ç³Šé€»è¾‘çš„æ¨å¹¿,ä¸ä¼ ç»Ÿæ•°å­¦å½¢æ€å­¦æœ‰ç›¸ä¼¼çš„è®¡ç®—ç»“æœå’Œç›¸ä¼¼çš„ä»£æ•°ç‰¹æ€§ã€‚æ¨¡ç³Šå½¢æ€å­¦é‡ç‚¹ç ”ç©¶nç»´ç©ºé—´ç›®æ ‡ç‰©ä½“çš„å½¢çŠ¶ç‰¹å¾å’Œå½¢æ€å˜æ¢,ä¸»è¦åº”ç”¨äºå›¾åƒå¤„ç†é¢†åŸŸ,å¦‚æ¨¡ç³Šå¢å¼ºã€æ¨¡ç³Šè¾¹ç¼˜æ£€æµ‹ã€æ¨¡ç³Šåˆ†å‰²ç­‰ã€‚


* **opencvç›¸å…³å‡½æ•°**

**å›¾åƒè…èš€:è¢«æ‰«æé“åˆ°åŸå§‹å›¾åƒä¸­çš„åƒç´ ç‚¹,åªæœ‰å½“å·ç§¯æ ¸å¯¹åº”çš„å…ƒç´ å€¼å‡ä¸º1æ—¶,å…¶å€¼æ‰ä¸º1,å¦åˆ™å€¼ä¸º0**

å‡½æ•°erode:dst = cv2.erode(src, kernel, iterations)

å‚æ•°
> * src:æºå›¾åƒ
> * kernel:å·ç§¯æ ¸ kernel = np.ones((5, 5), np.uint8)
> * iterations:è¿­ä»£æ¬¡æ•°

è¿”å›å€¼
> * dst : å¤„ç†ç»“æœ

**å›¾åƒè†¨èƒ€:è¢«æ‰«æé“åˆ°åŸå§‹å›¾åƒä¸­çš„åƒç´ ç‚¹,å½“å·ç§¯æ ¸å¯¹åº”çš„å…ƒç´ å€¼åªè¦æœ‰ä¸€ä¸ªä¸º1æ—¶,å…¶å€¼å°±ä¸º1,å¦åˆ™å€¼ä¸º0**

å‡½æ•°dilate:dst = cv2.dilate(src, kernel, iterations)

å‚æ•°
> * src : æºå›¾åƒ
> * kernel : å·ç§¯æ ¸
> * iterations : è¿­ä»£æ¬¡æ•°

è¿”å›å€¼
> * dst : å¤„ç†ç»“æœ

**ç»¼åˆçš„å‡½æ•°**

å‡½æ•°morphologyEx:result = cv2.morphologyEx(img, type, kernel)

å‚æ•°
> * img : æºå›¾åƒ
> * type : å›¾åƒå½¢æ€å­¦æ–¹æ³•
>     - å¼€è¿ç®—:cv2.MORPH\_OPEN (å¯ä»¥å»é™¤å™ªå£°,å¹¶ä¿æŒåŸæœ‰å½¢çŠ¶)
>     - é—­è¿ç®—:cv2.MORPH\_CLOSE (å…³é—­å‰æ™¯ç‰©ä½“å†…çš„å°å­”,æˆ–ç‰©ä½“ä¸Šçš„å°é»‘ç‚¹)
>     - æ¢¯åº¦è¿ç®—:cv2.MORPH\_GRADIENT (æ¢¯åº¦(image)=è†¨èƒ€(image)-è…èš€(image),å¾—åˆ°è½®å»“å›¾åƒ)
>     - ç¤¼å¸½è¿ç®—:cv2.MORPH\_TOPHAT (ç¤¼å¸½(image)=image-å¼€è¿ç®—(image),å¾—åˆ°å™ªå£°å›¾åƒ)
>     - é»‘å¸½è¿ç®—:cv2.MORPH\_BLACKHAT (é»‘å¸½(image)=é—­è¿ç®—(image)-image,å¾—åˆ°å›¾åƒå†…éƒ¨çš„å°å­”æˆ–è€…æ™¯è‰²ä¸­çš„å°é»‘ç‚¹)
> * kernel:å·ç§¯æ ¸

è¿”å›å€¼

> * result:morphologyExå‡½æ•°è¿ç®—ç»“æœ

```python
import sys

import cv2
import numpy as np
import matplotlib.pyplot as plt

filename = "WX20190927-154211@2x.png"
img = cv2.imread(filename, 0)  # ç›´æ¥è¯»ä¸ºç°åº¦å›¾åƒ
print(img.shape)
kernel = np.ones((17,17),np.uint8)

plt.figure(figsize=(int(sys.argv[1]),int(sys.argv[2])))
plt.subplot(4,2,1)
plt.imshow(img,'gray')     # æ˜¾ç¤ºåŸå›¾åƒ
plt.xticks([]),plt.yticks([]),plt.title('orignal')

erosion = cv2.erode(img,kernel,1)
plt.subplot(4,2,2),plt.imshow(erosion,'gray') # æ˜¾ç¤ºè…èš€å›¾åƒ
plt.xticks([]),plt.yticks([]),plt.title("erosion")

erosion = cv2.dilate(img,kernel,1)
plt.subplot(4,2,3),plt.imshow(erosion,'gray') # æ˜¾ç¤ºè†¨èƒ€å›¾åƒ
plt.xticks([]),plt.yticks([]),plt.title("dilate")

erosion = cv2.morphologyEx(img,cv2.MORPH_OPEN,kernel)
plt.subplot(4,2,4),plt.imshow(erosion,'gray') # æ˜¾ç¤ºå¼€è¿ç®—
plt.xticks([]),plt.yticks([]),plt.title("morph_open")

erosion = cv2.morphologyEx(img,cv2.MORPH_CLOSE,kernel)
plt.subplot(4,2,5),plt.imshow(erosion,'gray') # æ˜¾ç¤ºé—­è¿ç®—
plt.xticks([]),plt.yticks([]),plt.title("morph_close")

erosion = cv2.morphologyEx(img,cv2.MORPH_GRADIENT,kernel)
plt.subplot(4,2,6),plt.imshow(erosion,'gray') # æ˜¾ç¤ºæ¢¯åº¦è¿ç®—
plt.xticks([]),plt.yticks([]),plt.title("morph_gradient")

erosion = cv2.morphologyEx(img,cv2.MORPH_TOPHAT,kernel)
plt.subplot(4,2,7),plt.imshow(erosion,'gray') # æ˜¾ç¤ºé—­è¿ç®—
plt.xticks([]),plt.yticks([]),plt.title("morph_tophat")

erosion = cv2.morphologyEx(img,cv2.MORPH_BLACKHAT,kernel)
plt.subplot(4,2,8),plt.imshow(erosion,'gray') # æ˜¾ç¤ºé—­è¿ç®—
plt.xticks([]),plt.yticks([]),plt.title("morph_blackhat")

plt.savefig("xingtaixue.png")
# plt.show()
```

![](http://wx2.sinaimg.cn/large/006HJ6Ndly1g7e5jq4cdtj30jm10ktdr.jpg)

* **æ•°å­¦å½¢æ€å­¦åœ¨å›¾åƒå¤„ç†ä¸­çš„ä¸»è¦åº”ç”¨**

è¿‘å¹´æ¥,æ•°å­¦å½¢æ€å­¦åœ¨å›¾åƒå¤„ç†æ–¹é¢å¾—åˆ°äº†æ—¥ç›Šå¹¿æ³›çš„åº”ç”¨ã€‚ä¸‹é¢ä¸»è¦å°±æ•°å­¦å½¢æ€å­¦åœ¨è¾¹ç¼˜æ£€æµ‹ã€å›¾åƒåˆ†å‰²ã€å›¾åƒç»†åŒ–ä»¥åŠå™ªå£°æ»¤é™¤ç­‰æ–¹é¢çš„åº”ç”¨åšç®€è¦ä»‹ç»ã€‚

**è¾¹ç¼˜æ£€æµ‹**

è¾¹ç¼˜æ£€æµ‹æ˜¯å¤§å¤šæ•°å›¾åƒå¤„ç†å¿…ä¸å¯å°‘çš„ä¸€æ­¥,æä¾›äº†ç‰©ä½“å½¢çŠ¶çš„é‡è¦ä¿¡æ¯ã€‚å¯¹äºäºŒå€¼å›¾åƒ,è¾¹ç¼˜æ£€æµ‹æ˜¯æ±‚ä¸€ä¸ªé›†åˆ$A$çš„è¾¹ç•Œ,è®°ä¸º$B(A)$:

$$ \beta(A)=A-(A\odot B) $$

å¯¹äºç°åº¦å›¾åƒ,è¾¹ç¼˜æ£€æµ‹æ˜¯æ±‚ä¸€å¹…å›¾åƒçš„å½¢æ€å­¦æ¢¯åº¦,è®°ä¸º$g$ã€‚

æ•°å­¦å½¢æ€å­¦è¿ç®—ç”¨äºè¾¹ç¼˜æ£€æµ‹,å­˜åœ¨ç€ç»“æ„å…ƒç´ å•ä¸€çš„é—®é¢˜ã€‚å®ƒå¯¹ä¸ç»“æ„å…ƒç´ åŒæ–¹å‘çš„è¾¹ç¼˜æ•æ„Ÿ,è€Œä¸å…¶ä¸åŒæ–¹å‘çš„è¾¹ç¼˜(æˆ–å™ªå£°)ä¼šè¢«å¹³æ»‘æ‰,å³è¾¹ç¼˜çš„æ–¹å‘å¯ä»¥ç”±ç»“æ„å…ƒç´ çš„å½¢çŠ¶ç¡®å®šã€‚ä½†å¦‚æœé‡‡ç”¨å¯¹ç§°çš„ç»“æ„å…ƒç´ ,åˆä¼šå‡å¼±å¯¹å›¾åƒè¾¹ç¼˜çš„æ–¹å‘æ•æ„Ÿæ€§ã€‚æ‰€ä»¥åœ¨è¾¹ç¼˜æ£€æµ‹ä¸­,å¯ä»¥è€ƒè™‘ç”¨å¤šæ–¹ä½çš„å½¢æ€ç»“æ„å…ƒç´ ,è¿ç”¨ä¸åŒçš„ç»“æ„å…ƒç´ çš„é€»è¾‘ç»„åˆæ£€æµ‹å‡ºä¸åŒæ–¹å‘çš„è¾¹ç¼˜ã€‚

æ¢å‹‡ç­‰äººæ„é€ äº†8ä¸ªæ–¹å‘çš„å¤šæ–¹ä½å½¢æ€å­¦ç»“æ„å…ƒç´ ,åº”ç”¨åŸºæœ¬å½¢æ€è¿ç®—,å¾—åˆ°8ä¸ªæ–¹å‘çš„è¾¹ç¼˜æ£€æµ‹ç»“æœ,å†æŠŠè¿™äº›ç»“æœè¿›è¡Œå½’ä¸€åŒ–è¿ç®—ã€åŠ æƒæ±‚å’Œ,å¾—åˆ°æœ€ç»ˆçš„å›¾åƒè¾¹ç¼˜ã€‚è¯¥ç®—æ³•åœ¨ä¿æŒå›¾åƒç»†èŠ‚ç‰¹å¾å’Œå¹³æ»‘è¾¹ç¼˜ç­‰æ–¹é¢,å–å¾—äº†è¾ƒå¥½çš„æ•ˆæœã€‚

è¾¹ç¼˜æ£€æµ‹æ•ˆæœ:

![](http://hi.csdn.net/attachment/201201/5/0_1325736881qxp2.gif)

![](http://hi.csdn.net/attachment/201201/5/0_13257369062TdI.gif)

**å›¾åƒåˆ†å‰²**

åŸºäºæ•°å­¦å½¢æ€å­¦çš„å›¾åƒåˆ†å‰²ç®—æ³•æ˜¯åˆ©ç”¨æ•°å­¦å½¢æ€å­¦å˜æ¢,æŠŠå¤æ‚ç›®æ ‡Xåˆ†å‰²æˆä¸€ç³»åˆ—äº’ä¸ç›¸äº¤çš„ç®€å•å­é›†$X_1,X_2,\dots,X_N$,å³(å¯¹ç›®æ ‡Xçš„åˆ†å‰²è¿‡ç¨‹å¯æŒ‰ä¸‹é¢çš„æ–¹æ³•å®Œæˆ):

é¦–å…ˆæ±‚å‡º$X$çš„æœ€å¤§å†…æ¥â€œåœ†â€$X_1$,ç„¶åå°†$X_1$ä»$X$ä¸­å‡å»,å†æ±‚$X-X_1$çš„æœ€å¤§å†…æ¥â€œåœ†â€$X_2$,â€¦,ä¾æ­¤ç±»æ¨,ç›´åˆ°æœ€åå¾—åˆ°çš„é›†åˆä¸ºç©ºé›†ä¸ºæ­¢ã€‚ä¸‹é¢ä»¥äºŒå€¼å›¾åƒä¸ºä¾‹,ä»‹ç»ç”¨æ•°å­¦å½¢æ€å­¦æ–¹æ³•æ±‚è§£å­é›†$X_1,X_2,\dots,X_N$çš„è¿‡ç¨‹ã€‚

æ•°å­¦å½¢æ€å­¦ç”¨äºå›¾åƒåˆ†å‰²çš„ç¼ºç‚¹æ˜¯å¯¹è¾¹ç•Œå™ªå£°æ•æ„Ÿã€‚ä¸ºäº†æ”¹å–„è¿™ä¸€é—®é¢˜,åˆ˜å¿—æ•ç­‰äººæå‡ºäº†åŸºäºå›¾åƒæœ€å¤§å†…åˆ‡åœ†çš„æ•°å­¦å½¢æ€å­¦å½¢çŠ¶æè¿°å›¾åƒåˆ†å‰²ç®—æ³•å’ŒåŸºäºç›®æ ‡æœ€å°é—­åŒ…ç»“æ„å…ƒç´ çš„æ•°å­¦å½¢æ€å­¦å½¢çŠ¶æè¿°å›¾åƒåˆ†å‰²ç®—æ³•,å¹¶ä½¿ç”¨è¯¥ç®—æ³•å¯¹äºŒå€¼å›¾åƒè¿›è¡Œäº†åˆ†å‰²,å–å¾—äº†è¾ƒå¥½çš„æ•ˆæœã€‚é‚“ä¸–ä¼Ÿç­‰äººæå‡ºä¸€ç§åŸºäºæ•°å­¦å½¢æ€å­¦çš„æ·±åº¦å›¾åƒåˆ†å‰²ç®—æ³•ã€‚ä½œè€…é¦–å…ˆåˆ©ç”¨å½¢æ€å­¦ç®—å­è·å¾—åˆ†åˆ«å«æœ‰é˜¶è·ƒè¾¹ç¼˜ä¸å±‹è„Šè¾¹ç¼˜çš„å‡¸è„Šå’Œå‡¹è°·å›¾åƒ,ç„¶ååˆ©ç”¨æ§åˆ¶åŒºåŸŸç”Ÿé•¿è¿‡ç¨‹å¾—åˆ°æœ€ç»ˆçš„åˆ†å‰²ç»“æœã€‚ä¸ä¼ ç»Ÿæ–¹æ³•ç›¸æ¯”,è¯¥æ–¹æ³•é€Ÿåº¦å¿«,æŠ—å™ªæ€§èƒ½å¥½ã€‚

**å½¢æ€éª¨æ¶æå–**

å½¢æ€éª¨æ¶æè¿°äº†ç‰©ä½“çš„å½¢çŠ¶å’Œæ–¹å‘ä¿¡æ¯ã€‚å®ƒå…·æœ‰å¹³ç§»ä¸å˜æ€§ã€é€†æ‰©å¼ æ€§å’Œç­‰å¹‚æ€§ç­‰æ€§è´¨,æ˜¯ä¸€ç§æœ‰æ•ˆçš„å½¢çŠ¶æè¿°æ–¹æ³•ã€‚äºŒå€¼å›¾åƒAçš„å½¢æ€éª¨æ¶å¯ä»¥é€šè¿‡é€‰å®šåˆé€‚çš„ç»“æ„å…ƒç´ B,å¯¹Aè¿›è¡Œè¿ç»­è…èš€å’Œå¼€å¯è¿ç®—æ¥æ±‚å–,è®¾$S(A)$ä»£è¡¨Açš„éª¨æ¶ã€‚è’‹åˆšæ¯…ç­‰äººè¿ç”¨æ•°å­¦å½¢æ€å­¦æ–¹æ³•,å¯¹äº¤é€šæ ‡å¿—çš„å†…æ ¸å½¢çŠ¶æå–å½¢æ€éª¨æ¶å‡½æ•°,å°†å…¶ä½œä¸ºç”¨äºæ¨¡å¼åŒ¹é…çš„å½¢çŠ¶ç‰¹å¾ã€‚

å½¢æ€éª¨æ¶å‡½æ•°å®Œæ•´ç®€æ´åœ°è¡¨è¾¾äº†å½¢æ€éª¨æ¶çš„æ‰€æœ‰ä¿¡æ¯,å› æ­¤,æ ¹æ®å½¢æ€éª¨æ¶å‡½æ•°çš„æ¨¡å¼åŒ¹é…èƒ½å¤Ÿå®ç°å¯¹ä¸åŒå½¢çŠ¶ç‰©ä½“çš„è¯†åˆ«ã€‚ç®—æ³•å…·æœ‰ä½ç§»ä¸å˜æ€§,å› è€Œä½¿è¯†åˆ«æ›´å…·ç¨³å¥æ€§ã€‚

![](http://hi.csdn.net/attachment/201201/5/0_13257371883b6g.gif)

![](http://hi.csdn.net/attachment/201201/5/0_132573720449y5.gif)

å½¢æ€å­¦ç®—æ³•å¯¹äºæå–äº¤å‰çš„ç‰©ä½“,ä¼šäº§ç”Ÿæ–­è£‚,ä¸€èˆ¬ä¼šåœ¨æå–ä¹‹åç´§è·Ÿè¿æ¥æ“ä½œã€‚

**å™ªå£°æ»¤é™¤**

å¯¹å›¾åƒä¸­çš„å™ªå£°è¿›è¡Œæ»¤é™¤æ˜¯å›¾åƒé¢„å¤„ç†ä¸­ä¸å¯ç¼ºå°‘çš„æ“ä½œã€‚å°†å¼€å¯å’Œé—­åˆè¿ç®—ç»“åˆèµ·æ¥å¯æ„æˆå½¢æ€å­¦å™ªå£°æ»¤é™¤å™¨ã€‚å¯¹äºäºŒå€¼å›¾åƒ,å™ªå£°è¡¨ç°ä¸ºç›®æ ‡å‘¨å›´çš„å™ªå£°å—å’Œç›®æ ‡å†…éƒ¨çš„å™ªå£°å­”ã€‚ç”¨ç»“æ„å…ƒç´ Bå¯¹é›†åˆAè¿›è¡Œå¼€å¯æ“ä½œ,å°±å¯ä»¥å°†ç›®æ ‡å‘¨å›´çš„å™ªå£°å—æ¶ˆé™¤æ‰;ç”¨Bå¯¹Aè¿›è¡Œé—­åˆæ“ä½œ,åˆ™å¯ä»¥å°†ç›®æ ‡å†…éƒ¨çš„å™ªå£°å­”æ¶ˆé™¤æ‰ã€‚è¯¥æ–¹æ³•ä¸­,å¯¹ç»“æ„å…ƒç´ çš„é€‰å–ç›¸å½“é‡è¦,å®ƒåº”å½“æ¯”æ‰€æœ‰çš„å™ªå£°å­”å’Œå™ªå£°å—éƒ½è¦å¤§ã€‚

å¯¹äºç°åº¦å›¾åƒ,æ»¤é™¤å™ªå£°å°±æ˜¯è¿›è¡Œå½¢æ€å­¦å¹³æ»‘ã€‚å®é™…ä¸­å¸¸ç”¨å¼€å¯è¿ç®—æ¶ˆé™¤ä¸ç»“æ„å…ƒç´ ç›¸æ¯”å°ºå¯¸è¾ƒå°çš„äº®ç»†èŠ‚,è€Œä¿æŒå›¾åƒæ•´ä½“ç°åº¦å€¼å’Œå¤§çš„äº®åŒºåŸŸåŸºæœ¬ä¸å˜;ç”¨é—­åˆè¿ç®—æ¶ˆé™¤ä¸ç»“æ„å…ƒç´ ç›¸æ¯”å°ºå¯¸è¾ƒå°çš„æš—ç»†èŠ‚,è€Œä¿æŒå›¾åƒæ•´ä½“ç°åº¦å€¼å’Œå¤§çš„æš—åŒºåŸŸåŸºæœ¬ä¸å˜ã€‚å°†è¿™ä¸¤ç§æ“ä½œç»¼åˆèµ·æ¥å¯è¾¾åˆ°æ»¤é™¤äº®åŒºå’Œæš—åŒºä¸­å„ç±»å™ªå£°çš„æ•ˆæœã€‚åŒæ ·çš„,ç»“æ„å…ƒç´ çš„é€‰å–ä¹Ÿæ˜¯ä¸ªé‡è¦é—®é¢˜ã€‚

* **é€‰å–ç»“æ„å…ƒç´ çš„æ–¹æ³•**

åˆ†æè¡¨æ˜,å„ç§æ•°å­¦å½¢æ€å­¦ç®—æ³•çš„åº”ç”¨å¯åˆ†è§£ä¸ºå½¢æ€å­¦è¿ç®—å’Œç»“æ„å…ƒç´ é€‰æ‹©ä¸¤ä¸ªåŸºæœ¬é—®é¢˜,å½¢æ€å­¦è¿ç®—çš„è§„åˆ™å·²ç”±å®šä¹‰ç¡®å®š,äºæ˜¯å½¢æ€å­¦ç®—æ³•çš„æ€§èƒ½å°±å–å†³äºç»“æ„å…ƒç´ çš„é€‰æ‹©,äº¦å³ç»“æ„å…ƒç´ å†³å®šç€å½¢æ€å­¦ç®—æ³•çš„ç›®çš„å’Œæ€§èƒ½ã€‚å› æ­¤å¦‚ä½•è‡ªé€‚åº”åœ°ä¼˜åŒ–ç¡®å®šç»“æ„å…ƒç´ ,å°±æˆä¸ºå½¢æ€å­¦é¢†åŸŸä¸­äººä»¬é•¿æœŸå…³æ³¨çš„ç ”ç©¶çƒ­ç‚¹å’ŒæŠ€æœ¯éš¾ç‚¹ã€‚ç›®å‰è¾ƒå¤šé‡‡ç”¨å¤šä¸ªç»“æ„å…ƒç´ å¯¹å›¾åƒè¿›è¡Œå¤„ç†çš„æ–¹æ³•ã€‚

**å¤šç»“æ„å…ƒç´ è¿ç®—**

åœ¨è®¸å¤šå½¢æ€å­¦åº”ç”¨ä¸­,å¾€å¾€åªé‡‡ç”¨ä¸€ä¸ªç»“æ„å…ƒç´ ,è¿™é€šå¸¸ä¸èƒ½äº§ç”Ÿæ»¡æ„çš„ç»“æœã€‚åœ¨æ¨¡å¼è¯†åˆ«ä¸­,å¦‚æœè¦æå–æŸä¸ªç‰¹å®šçš„æ¨¡å¼,åªé‡‡ç”¨ä¸€ä¸ªç»“æ„å…ƒç´ ,é‚£ä¹ˆ,åªæœ‰ä¸ç»“æ„å…ƒç´ å½¢çŠ¶ã€å¤§å°å®Œå…¨ç›¸åŒçš„æ¨¡å¼æ‰èƒ½è¢«æå–,è€Œä¸æ­¤ç»“æ„å…ƒç´ è¡¨ç¤ºçš„æ¨¡å¼å³ä½¿æœ‰å¾®å°å·®åˆ«çš„å…¶ä»–æ¨¡å¼çš„ä¿¡æ¯éƒ½ä¸èƒ½è·å–ã€‚

è§£å†³æ­¤é—®é¢˜çš„ä¸€ä¸ªæœ‰æ•ˆæ–¹æ³•ä¹‹ä¸€å°±æ˜¯å°†å½¢æ€å­¦è¿ç®—ä¸é›†åˆè¿ç®—ç»“åˆèµ·æ¥,åŒæ—¶é‡‡ç”¨å¤šä¸ªç»“æ„å…ƒç´ ,åˆ†åˆ«å¯¹å›¾åƒè¿›è¡Œè¿ç®—,ç„¶åå°†è¿ç®—åçš„å›¾åƒåˆå¹¶èµ·æ¥,å³å¤šç»“æ„å…ƒç´ å½¢æ€å­¦è¿ç®—ã€‚

**ç”¨é—ä¼ ç®—æ³•é€‰å–ç»“æ„å…ƒç´ **

é—ä¼ ç®—æ³•çš„æ€æƒ³æ¥æºäºè‡ªç„¶ç•Œç‰©ç«å¤©æ‹©ã€ä¼˜èƒœåŠ£æ±°ã€é€‚è€…ç”Ÿå­˜çš„æ¼”åŒ–è§„å¾‹å’Œç”Ÿç‰©è¿›åŒ–åŸç†,å¹¶å¼•ç”¨éšæœºç»Ÿè®¡ç†è®ºè€Œå½¢æˆ,å…·æœ‰é«˜æ•ˆå¹¶è¡Œå…¨å±€ä¼˜åŒ–æœç´¢èƒ½åŠ›,èƒ½æœ‰æ•ˆåœ°è§£å†³æœºå™¨å­¦ä¹ ä¸­å‚æ•°çš„å¤æ‚ä¼˜åŒ–å’Œç»„åˆä¼˜åŒ–ç­‰éš¾é¢˜ã€‚

è¿‘å¹´æ¥ä¸å°‘å›½å¤–å­¦è€…å·²è¿›è¡Œäº†è¿™æ–¹é¢çš„æ¢ç´¢ä¸ç ”ç©¶,Ehrgardtè®¾è®¡äº†å½¢æ€æ»¤æ³¢çš„é—ä¼ ç®—æ³•,ç”¨äºäºŒå€¼å›¾åƒçš„å»å™ªå’Œæ ¹æ®äºŒå€¼çº¹ç†ç‰¹æ€§æ¶ˆé™¤é¢„å®šç›®æ ‡;Huttumenåˆ©ç”¨é—ä¼ ç®—æ³•æ„é€ äº†è½¯å¼å½¢æ€æ»¤æ³¢å™¨åŠå…¶å‚æ•°ä¼˜åŒ–çš„è®¾è®¡æ–¹æ³•,ä»¥å®ç°ç°åº¦å›¾åƒçš„é™å™ªåŠŸèƒ½ã€‚ä½™å†œã€æäºˆèœ€ç­‰äººç”¨é—ä¼ ç®—æ³•åœ¨è‡ªç„¶æ™¯è±¡çš„ç›®æ ‡æ£€æµ‹ä¸æå–æ–¹é¢è¿›è¡Œäº†ç ”ç©¶,é€šè¿‡è‡ªé€‚åº”ä¼˜åŒ–è®­ç»ƒä½¿ç»“æ„å…ƒç´ å…·æœ‰å›¾åƒç›®æ ‡çš„å½¢æ€ç»“æ„ç‰¹å¾,ä»è€Œèµ‹äºˆç»“æ„å…ƒç´ ç‰¹å®šçš„çŸ¥è¯†,ä½¿å½¢æ€æ»¤æ³¢è¿‡ç¨‹èå…¥ç‰¹æœ‰çš„æ™ºèƒ½,ä»¥å®ç°å¯¹å¤æ‚å˜åŒ–çš„å›¾åƒå…·æœ‰è‰¯å¥½çš„æ»¤æ³¢æ€§èƒ½å’Œç¨³å¥çš„é€‚åº”èƒ½åŠ›ã€‚å…¶å®è´¨æ˜¯è§£å†³æ»¤æ³¢å™¨è®¾è®¡ä¸­çŸ¥è¯†è·å–å’ŒçŸ¥è¯†ç²¾ç‚¼çš„æœºå™¨å­¦ä¹ é—®é¢˜ã€‚

* **æ•°å­¦å½¢æ€å­¦å­˜åœ¨çš„é—®é¢˜ä¸è¿›ä¸€æ­¥çš„ç ”ç©¶æ–¹å‘**

æ•°å­¦å½¢æ€å­¦æ˜¯ä¸€é—¨å»ºç«‹åœ¨é›†è®ºåŸºç¡€ä¹‹ä¸Šçš„å­¦ç§‘,æ˜¯å‡ ä½•å½¢çŠ¶åˆ†æå’Œæè¿°çš„æœ‰åŠ›å·¥å…·ã€‚è¿‘å¹´æ¥,æ•°å­¦å½¢æ€å­¦åœ¨æ•°å­—å›¾åƒå¤„ç†ã€è®¡ç®—æœºè§†è§‰ä¸æ¨¡å¼è¯†åˆ«ç­‰é¢†åŸŸä¸­å¾—åˆ°äº†è¶Šæ¥è¶Šå¹¿æ³›çš„åº”ç”¨,æ¸æ¸å½¢æˆäº†ä¸€ç§æ–°çš„æ•°å­—å›¾åƒåˆ†ææ–¹æ³•å’Œç†è®º,å¼•èµ·äº†å›½å†…å¤–ç›¸å…³é¢†åŸŸç ”ç©¶äººå‘˜çš„å¹¿æ³›å…³æ³¨ã€‚ç›®å‰,æ•°å­¦å½¢æ€å­¦å­˜åœ¨çš„é—®é¢˜åŠç ”ç©¶æ–¹å‘ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢:

> * å½¢æ€è¿ç®—å®è´¨ä¸Šæ˜¯ä¸€ç§äºŒç»´å·ç§¯è¿ç®—,å½“å›¾åƒç»´æ•°è¾ƒå¤§æ—¶,ç‰¹åˆ«æ˜¯ç”¨ç°åº¦å½¢æ€å­¦ã€è½¯æ•°å­¦å½¢æ€å­¦ã€æ¨¡ç³Šå½¢æ€å­¦ç­‰æ–¹æ³•æ—¶,è¿ç®—é€Ÿåº¦å¾ˆæ…¢,å› è€Œä¸é€‚äºå®æ—¶å¤„ç†ã€‚
> * ç”±äºç»“æ„å…ƒç´ å¯¹å½¢æ€è¿ç®—çš„ç»“æœæœ‰å†³å®šæ€§çš„ä½œç”¨,æ‰€ä»¥,éœ€ç»“åˆå®é™…åº”ç”¨èƒŒæ™¯å’ŒæœŸæœ›åˆç†é€‰æ‹©ç»“æ„å…ƒç´ çš„å¤§å°ä¸å½¢çŠ¶ã€‚
> * è½¯æ•°å­¦å½¢æ€å­¦ä¸­å…³äºç»“æ„å…ƒç´ æ ¸å¿ƒã€è½¯è¾¹ç•Œçš„å®šä¹‰,åŠå¯¹åŠ æƒç»Ÿè®¡æ¬¡æ•°\*çš„é€‰æ‹©ä¹Ÿå…·æœ‰è¾ƒå¤§çš„çµæ´»æ€§,åº”æ ¹æ®å›¾åƒæ‹“æ‰‘ç»“æ„åˆç†é€‰æ‹©,æ²¡æœ‰ç»Ÿä¸€çš„è®¾è®¡æ ‡å‡†ã€‚
> * ä¸ºè¾¾åˆ°æœ€ä½³çš„æ»¤æ³¢æ•ˆæœ,éœ€ç»“åˆå›¾åƒçš„æ‹“æ‰‘ç‰¹æ€§é€‰æ‹©å½¢æ€å¼€ã€é—­è¿ç®—çš„å¤åˆæ–¹å¼ã€‚
> * å¯¹æ¨¡ç³Šå½¢æ€å­¦,ä¸åŒçš„æ¨¡ç³Šç®—å­ä¼šç›´æ¥å½±å“æ¨¡ç³Šå½¢æ€å­¦çš„å®šä¹‰åŠå…¶è¿ç®—ç»“æœã€‚
> * æœ‰å¾…è¿›ä¸€æ­¥å°†æ•°å­¦å½¢æ€å­¦ä¸ç¥ç»ç½‘ç»œã€æ¨¡ç³Šæ•°å­¦ç»“åˆç ”ç©¶ç°åº¦å›¾åƒã€å½©è‰²å›¾åƒçš„å¤„ç†å’Œåˆ†ææ–¹æ³•ã€‚
> * æœ‰å¾…è¿›ä¸€æ­¥ç ”ç©¶å¼€å‘å½¢æ€è¿ç®—çš„å…‰å­¦å®ç°åŠå…¶å®ƒç¡¬ä»¶å®ç°æ–¹æ³•ã€‚
> * æœ‰å¾…å°†å½¢æ€å­¦ä¸å°æ³¢ã€åˆ†å½¢ç­‰æ–¹æ³•ç»“åˆèµ·æ¥å¯¹ç°æœ‰å›¾åƒå¤„ç†æ–¹æ³•è¿›è¡Œæ”¹è¿›,è¿›ä¸€æ­¥æ¨å¹¿åº”ç”¨ã€‚æ‰€ä»¥å¦‚ä½•å®ç°ç°åº¦å½¢æ€å­¦ã€è½¯æ•°å­¦å½¢æ€å­¦ã€æ¨¡ç³Šè½¯æ•°å­¦å½¢æ€å­¦çš„å¿«é€Ÿç®—æ³•,å¦‚ä½•æ”¹å–„å½¢æ€è¿ç®—çš„é€šç”¨æ€§,å¢å¼ºå½¢æ€è¿ç®—çš„é€‚åº”æ€§,å¹¶ç»“åˆæ•°å­¦å½¢æ€å­¦çš„æœ€æ–°åº”ç”¨è¿›å±•,å°†å…¶åº”ç”¨åˆ°å›¾åƒå¤„ç†é¢†åŸŸ,ä¸°å¯Œå’Œå‘å±•åˆ©ç”¨æ•°å­¦å½¢æ€å­¦çš„å›¾åƒå¤„ç†ä¸åˆ†ææ–¹æ³•,æˆä¸ºæ•°å­¦å½¢æ€å­¦ä»Šåçš„å‘å±•æ–¹å‘ã€‚


æ•°å­¦å½¢æ€å­¦å¯¹å›¾åƒçš„å¤„ç†å…·æœ‰ç›´è§‚ä¸Šçš„ç®€æ˜æ€§å’Œæ•°å­¦ä¸Šçš„ä¸¥è°¨æ€§,åœ¨å®šé‡æè¿°å›¾åƒçš„å½¢æ€ç‰¹å¾ä¸Šå…·æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿,ä¸ºåŸºäºå½¢çŠ¶ç»†èŠ‚è¿›è¡Œå›¾åƒå¤„ç†æä¾›äº†å¼ºæœ‰åŠ›çš„æ‰‹æ®µã€‚å»ºç«‹åœ¨é›†åˆç†è®ºåŸºç¡€ä¸Šçš„æ•°å­¦å½¢æ€å­¦,ä¸»è¦é€šè¿‡é€‰æ‹©ç›¸åº”çš„ç»“æ„å…ƒç´ é‡‡ç”¨è†¨èƒ€ã€è…èš€ã€å¼€å¯ã€é—­åˆ#ç§åŸºæœ¬è¿ç®—çš„ç»„åˆæ¥å¤„ç†å›¾åƒã€‚æ•°å­¦å½¢æ€å­¦åœ¨å›¾åƒå¤„ç†ä¸­çš„åº”ç”¨å¹¿æ³›,æœ‰è®¸å¤šå®ç”¨çš„ç®—æ³•,ä½†åœ¨æ¯ç§ç®—æ³•ä¸­ç»“æ„å…ƒç´ çš„é€‰å–éƒ½æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚






## å››ã€opencvç‰¹å¾å­¦ä¹ 


### ä½¿ç”¨Haaråˆ†ç±»å™¨è¿›è¡Œé¢éƒ¨æ£€æµ‹




## å…­ã€å›¾åƒåˆ†å‰²ä¼ ç»Ÿæ–¹æ³•

https://zhuanlan.zhihu.com/p/30732385



import cv2
import numpy as np

#image_name = input("Enter the name of the picture:")

def detect(image_name):
    print("æ­£åœ¨è¯†åˆ«"+image_name+'...')
    # Load the image and convert it to grayscale
    image = cv2.imread(image_name)
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

    # compute the Scharr gradient magnitude representation of the iamges
    # in both the x and y direction
    # åŸæ¥ä»£ç ä¸‹é¢æ˜¯cv2.cv.CV_32Fä¼šæŠ¥é”™->AttributeError: module 'cv2' has no attribute 'cv'
    # åœ¨æ–°ç‰ˆæœ¬å˜ä¸ºcv2.CV_32F
    gradX = cv2.Sobel(gray, ddepth = cv2.CV_32F, dx = 1, dy = 0, ksize = -1)
    gradY = cv2.Sobel(gray, ddepth = cv2.CV_32F, dx = 0, dy = 1, ksize = -1)

    # substract the y-gradient from the x-gradient
    gradient = cv2.subtract(gradX, gradY)
    gradient = cv2.convertScaleAbs(gradient)

    # blur and threhold the image
    # è¿™é‡Œ(13,13)æ˜¯kernel matrix sizeï¼Œè‡ªå·±å¯ä»¥æ”¹å˜çœ‹çœ‹è¯†åˆ«æ•ˆæœ
    blurred = cv2.blur(gradient, (13, 13))
    # è¿™é‡Œçš„é˜€å€¼200,255ä¹Ÿå¯ä»¥æ ¹æ®å›¾ç‰‡è‡ªå®šä¹‰
    (_, thresh) = cv2.threshold(blurred, 200, 255, cv2.THRESH_BINARY)

    # construct a closing kernel and apply it to the thresholded image
    # (20, 15)ä¹Ÿæ˜¯ä¸€ä¸ªå‚æ•°ï¼Œç”¨æ¥è·å–éœ€è¦çš„kernel
    kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (20, 15))
    closed = cv2.morphologyEx(thresh, cv2.MORPH_CLOSE, kernel)

    # perform a series of erosions and dilations
    closed = cv2.erode(closed, None, iterations = 4)
    closed = cv2.dilate(closed, None, iterations = 4)

    # Find the contours in the thresholded image, then sort the contours
    # by their area, keeping only the largest one
    # ValueError: too many values to unpack (expected 2)
    (img,cnts, _) = cv2.findContours(closed.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
    c = sorted(cnts, key = cv2.contourArea, reverse = True)[0]
    # compute the rotated bounding box of the largest contour
    rect = cv2.minAreaRect(c)
    # åŸæ–‡è¿™é‡Œä½¿ç”¨cv2.cv.BoxPointsï¼Œæ–°ç‰ˆæœ¬å·²ç»ç§»é™¤ï¼Œæ¢ä¸ºcv2.boxPoints
    box = np.int0(cv2.boxPoints(rect))

    # draw a bounding box around the detected barcode
    # and display the image
    cv2.drawContours(image, [box], -1, (0,255,0), 3)


    cv2.imshow(image_name, image)
    cv2.waitKey(0)
    print("Done...\n##################################")

imgs_pro.py

# -*- coding: utf-8 -*-
"""
Created on Mon Dec 26 23:22:01 2016

@author: Administrator
"""
import os
from bar_code import detect
# åˆ‡æ¢åˆ°æµ‹è¯•å›¾ç‰‡æ–‡ä»¶å¤¹
os.chdir('test-imgs')
# æ‰¾åˆ°æ‰€æœ‰çš„æµ‹è¯•å›¾ç‰‡æ–‡ä»¶å
image_names = os.listdir()

if __name__=='__main__':
    for image_name in image_names:
        detect(image_name)



        
https://blog.csdn.net/zmdsjtu/article/details/80736258



https://blog.csdn.net/stdcoutzyx/article/details/34842233



åŸºäºHaarç‰¹å¾çš„Adaboostçº§è”äººè„¸æ£€æµ‹åˆ†ç±»å™¨,ç®€ç§°haaråˆ†ç±»å™¨ã€‚é€šè¿‡è¿™ä¸ªç®—æ³•çš„åå­—,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªç®—æ³•å…¶å®åŒ…å«äº†å‡ ä¸ªå…³é”®ç‚¹:Haarç‰¹å¾ã€Adaboostã€çº§è”ã€‚

1Â Â Â Â Â Â Â Â ç®—æ³•è¦ç‚¹
Haaråˆ†ç±»å™¨ = Haar-likeç‰¹å¾ + ç§¯åˆ†å›¾æ–¹æ³• + AdaBoost +çº§è”ï¼›

Haaråˆ†ç±»å™¨ç®—æ³•çš„è¦ç‚¹å¦‚ä¸‹ï¼š

a)Â Â Â Â Â Â Â Â ä½¿ç”¨Haar-likeç‰¹å¾åšæ£€æµ‹ã€‚

b)Â Â Â Â Â Â Â ä½¿ç”¨ç§¯åˆ†å›¾ï¼ˆIntegralImageï¼‰å¯¹Haar-likeç‰¹å¾æ±‚å€¼è¿›è¡ŒåŠ é€Ÿã€‚

c)Â Â Â Â Â Â Â Â ä½¿ç”¨AdaBoostç®—æ³•è®­ç»ƒåŒºåˆ†äººè„¸å’Œéäººè„¸çš„å¼ºåˆ†ç±»å™¨ã€‚

d)Â Â Â Â Â Â Â ä½¿ç”¨ç­›é€‰å¼çº§è”æŠŠåˆ†ç±»å™¨çº§è”åˆ°ä¸€èµ·ï¼Œæé«˜å‡†ç¡®ç‡ã€‚

2Â Â Â Â Â Â Â Â å†å²
åœ¨2001å¹´ï¼ŒViolaå’ŒJonesä¸¤ä½å¤§ç‰›å‘è¡¨äº†ç»å…¸çš„ã€ŠRapid Object Detectionusing a Boosted Cascade of Simple Featuresã€‹å’Œã€ŠRobust Real-Time Face Detectionã€‹ï¼Œåœ¨AdaBoostç®—æ³•çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨Haar-likeå°æ³¢ç‰¹å¾å’Œç§¯åˆ†å›¾æ–¹æ³•è¿›è¡Œäººè„¸æ£€æµ‹ï¼Œä»–ä¿©ä¸æ˜¯æœ€æ—©ä½¿ç”¨æå‡ºå°æ³¢ç‰¹å¾çš„ï¼Œä½†æ˜¯ä»–ä»¬è®¾è®¡äº†é’ˆå¯¹äººè„¸æ£€æµ‹æ›´æœ‰æ•ˆçš„ç‰¹å¾ï¼Œå¹¶å¯¹AdaBoostè®­ç»ƒå‡ºçš„å¼ºåˆ†ç±»å™¨è¿›è¡Œçº§è”ã€‚è¿™å¯ä»¥è¯´æ˜¯äººè„¸æ£€æµ‹å²ä¸Šé‡Œç¨‹ç¢‘å¼çš„ä¸€ç¬”äº†ï¼Œä¹Ÿå› æ­¤å½“æ—¶æå‡ºçš„è¿™ä¸ªç®—æ³•è¢«ç§°ä¸ºViola-Jonesæ£€æµ‹å™¨ã€‚åˆè¿‡äº†ä¸€æ®µæ—¶é—´ï¼ŒRainerLienhartå’ŒJochen Maydtä¸¤ä½å¤§ç‰›å°†è¿™ä¸ªæ£€æµ‹å™¨è¿›è¡Œäº†æ‰©å±•ï¼Œæœ€ç»ˆå½¢æˆäº†OpenCVç°åœ¨çš„Haaråˆ†ç±»å™¨ã€‚

AdaBoostæ˜¯Freundå’ŒSchapireåœ¨1995å¹´æå‡ºçš„ç®—æ³•ï¼Œæ˜¯å¯¹ä¼ ç»ŸBoostingç®—æ³•çš„ä¸€å¤§æå‡ã€‚Boostingç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ˜¯å°†å¼±å­¦ä¹ æ–¹æ³•æå‡æˆå¼ºå­¦ä¹ ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯â€œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸€ä¸ªè¯¸è‘›äº®â€

**Haarç‰¹å¾**

ä»€ä¹ˆæ˜¯ç‰¹å¾ï¼Œç‰¹å¾å°±æ˜¯åˆ†ç±»å™¨çš„è¾“å…¥ã€‚æŠŠå®ƒæ”¾åœ¨ä¸‹é¢çš„æƒ…æ™¯ä¸­æ¥æè¿°ï¼Œå‡è®¾åœ¨äººè„¸æ£€æµ‹æ—¶æˆ‘ä»¬éœ€è¦æœ‰è¿™ä¹ˆä¸€ä¸ªå­çª—å£åœ¨å¾…æ£€æµ‹çš„å›¾ç‰‡çª—å£ä¸­ä¸æ–­çš„ç§»ä½æ»‘åŠ¨ï¼Œå­çª—å£æ¯åˆ°ä¸€ä¸ªä½ç½®ï¼Œå°±ä¼šè®¡ç®—å‡ºè¯¥åŒºåŸŸçš„ç‰¹å¾ï¼Œç„¶åç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„çº§è”åˆ†ç±»å™¨å¯¹è¯¥ç‰¹å¾è¿›è¡Œç­›é€‰ï¼Œä¸€æ—¦è¯¥ç‰¹å¾é€šè¿‡äº†æ‰€æœ‰å¼ºåˆ†ç±»å™¨çš„ç­›é€‰ï¼Œåˆ™åˆ¤å®šè¯¥åŒºåŸŸä¸ºäººè„¸ã€‚

é‚£ä¹ˆè¿™ä¸ªç‰¹å¾å¦‚ä½•è¡¨ç¤ºå‘¢ï¼Ÿå¥½äº†ï¼Œè¿™å°±æ˜¯å¤§ç‰›ä»¬å¹²çš„å¥½äº‹äº†ã€‚åäººç§°è¿™ä»–ä»¬æå‡ºæ¥çš„è¿™äº›ä¸œè¥¿å«Haar-Likeç‰¹å¾ã€‚

Violaå¤§ç‰›åœ¨[1]ä¸­æå‡ºçš„haarç‰¹å¾å¦‚ä¸‹ï¼š



Rainerå¤§ç‰›æ”¹è¿›äº†è¿™äº›ç‰¹å¾ï¼Œæå‡ºäº†æ›´å¤šçš„haarç‰¹å¾ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š



è¿™äº›æ‰€è°“çš„ç‰¹å¾ä¸å°±æ˜¯ä¸€å †å †å¸¦æ¡çº¹çš„çŸ©å½¢ä¹ˆï¼Œåˆ°åº•æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿæˆ‘è¿™æ ·ç»™å‡ºè§£é‡Šï¼Œå°†ä¸Šé¢çš„ä»»æ„ä¸€ä¸ªçŸ©å½¢æ”¾åˆ°äººè„¸åŒºåŸŸä¸Šï¼Œç„¶åï¼Œå°†ç™½è‰²åŒºåŸŸçš„åƒç´ å’Œå‡å»é»‘è‰²åŒºåŸŸçš„åƒç´ å’Œï¼Œå¾—åˆ°çš„å€¼æˆ‘ä»¬æš‚ä¸”ç§°ä¹‹ä¸ºäººè„¸ç‰¹å¾å€¼ï¼Œå¦‚æœä½ æŠŠè¿™ä¸ªçŸ©å½¢æ”¾åˆ°ä¸€ä¸ªéäººè„¸åŒºåŸŸï¼Œé‚£ä¹ˆè®¡ç®—å‡ºçš„ç‰¹å¾å€¼åº”è¯¥å’Œäººè„¸ç‰¹å¾å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œä¸”è¶Šä¸ä¸€æ ·è¶Šå¥½ï¼Œæ‰€ä»¥è¿™äº›æ–¹å—çš„ç›®çš„å°±æ˜¯æŠŠäººè„¸ç‰¹å¾é‡åŒ–ï¼Œä»¥åŒºåˆ†äººè„¸å’Œéäººè„¸ã€‚

4Â Â Â Â Â Â Â Â Adaboostç®—æ³•
æœ¬èŠ‚æ—¨åœ¨ä»‹ç»AdaBooståœ¨Haaråˆ†ç±»å™¨ä¸­çš„åº”ç”¨ï¼Œæ‰€ä»¥åªæ˜¯æè¿°äº†å®ƒåœ¨Haaråˆ†ç±»å™¨ä¸­çš„ç‰¹æ€§ï¼Œè€Œå®é™…ä¸ŠAdaBoostæ˜¯ä¸€ç§å…·æœ‰ä¸€èˆ¬æ€§çš„åˆ†ç±»å™¨æå‡ç®—æ³•ï¼Œå®ƒä½¿ç”¨çš„åˆ†ç±»å™¨å¹¶ä¸å±€é™æŸä¸€ç‰¹å®šç®—æ³•ã€‚

[1]ä¸­ç»™å‡ºçš„Adaboostç®—æ³•æµç¨‹å¦‚ä¸‹å›¾ã€‚





ç”±adabooståœ¨haarç‰¹å¾ä¸Šæ„å»ºåˆ†ç±»å™¨çš„æµç¨‹å¯çŸ¥ï¼Œadaboostç®—æ³•å°±æ˜¯æ„å»ºå¤šä¸ªç®€å•çš„åˆ†ç±»å™¨ï¼Œæ¯ä¸ªç®€å•çš„åˆ†ç±»å™¨éƒ½å»ºç«‹åœ¨ä¹‹å‰åˆ†ç±»å™¨çš„åŸºç¡€ä¸Šï¼ˆå¯¹ä¹‹å‰åˆ†ç±»å™¨åˆ†é”™äº†çš„æ ·ä¾‹æé«˜å…¶æƒé‡ï¼‰ï¼Œç„¶åå°†è¿™äº›åˆ†ç±»å™¨åŠ æƒï¼Œå¾—åˆ°ä¸€ä¸ªå¼ºå¤§çš„åˆ†ç±»å™¨ã€‚

Adaboostçš„æ¯ä¸€æ­¥è®­ç»ƒå‡ºçš„åˆ†ç±»å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…¶ä¸­ï¼Œfè¡¨ç¤ºç‰¹å¾çš„å€¼ï¼Œthetaè¡¨ç¤ºé˜ˆå€¼ï¼Œpåˆ™è¡¨ç¤ºä¸ç­‰å¼çš„æ–¹å‘ã€‚è¿™æ ·çš„ä¸€ä¸ªåˆ†ç±»å™¨å°±æ˜¯åŸºäºä¸€ä¸ªç‰¹å¾çš„å¼±åˆ†ç±»å™¨ã€‚



Â 

æ›´è¿›ä¸€æ­¥ï¼Œadaboostçš„ä¸€èˆ¬ç®—æ³•æ¡†æ¶å¦‚ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒDiscrete Adaboostå’ŒGentleAdabooståœ¨åˆ†ç±»å™¨çš„è®¡ç®—ä¸Šå’Œæƒé‡çš„æ›´æ–°ä¸Šæ˜¯æœ‰å·®åˆ«çš„ã€‚è¿˜æœ‰ä¸€ç§æ˜¯RealAdaboostï¼Œå³åˆ†ç±»å™¨è¾“å‡ºçš„æ˜¯ä¸€ä¸ªæ¦‚ç‡è€Œä¸åªæ˜¯+1ä¸-1ã€‚[3]ä¸­å°±æ¯”è¾ƒäº†è¿™ä¸‰ç§Adaboostçš„å˜ç§çš„æ•ˆæœã€‚





5Â Â Â Â Â Â Â Â çº§è”
ä»€ä¹ˆæ˜¯çº§è”åˆ†ç±»å™¨ï¼Ÿçº§è”åˆ†ç±»å™¨å°±æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸€ç§é€€åŒ–äº†çš„å†³ç­–æ ‘ã€‚ä¸ºä»€ä¹ˆè¯´æ˜¯é€€åŒ–äº†çš„å†³ç­–æ ‘å‘¢ï¼Ÿæ˜¯å› ä¸ºä¸€èˆ¬å†³ç­–æ ‘ä¸­ï¼Œåˆ¤æ–­åçš„ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¼šæœ‰æ–°çš„åˆ†æ”¯å‡ºç°ï¼Œè€Œçº§è”åˆ†ç±»å™¨ä¸­ï¼Œå›¾åƒè¢«æ‹’ç»åå°±ç›´æ¥è¢«æŠ›å¼ƒï¼Œä¸ä¼šå†æœ‰åˆ¤æ–­äº†ã€‚



çº§è”å¼ºåˆ†ç±»å™¨çš„ç­–ç•¥æ˜¯ï¼Œå°†è‹¥å¹²ä¸ªå¼ºåˆ†ç±»å™¨ç”±ç®€å•åˆ°å¤æ‚æ’åˆ—ï¼Œå¸Œæœ›ç»è¿‡è®­ç»ƒä½¿æ¯ä¸ªå¼ºåˆ†ç±»å™¨éƒ½æœ‰è¾ƒé«˜æ£€æµ‹ç‡ï¼Œè€Œè¯¯è¯†ç‡å¯ä»¥æ”¾ä½ï¼Œæ¯”å¦‚å‡ ä¹99%çš„äººè„¸å¯ä»¥é€šè¿‡ï¼Œä½†50%çš„éäººè„¸ä¹Ÿå¯ä»¥é€šè¿‡ï¼Œè¿™æ ·å¦‚æœæœ‰20ä¸ªå¼ºåˆ†ç±»å™¨çº§è”ï¼Œé‚£ä¹ˆä»–ä»¬çš„æ€»è¯†åˆ«ç‡ä¸º0.99^20çº¦ç­‰äº98%ï¼Œé”™è¯¯æ¥å—ç‡ä¹Ÿä»…ä¸º0.5^20çº¦ç­‰äº0.0001%ã€‚è¿™æ ·çš„æ•ˆæœå°±å¯ä»¥æ»¡è¶³ç°å®çš„éœ€è¦äº†ã€‚æ–‡çŒ®[1]ä¸­ç»™å‡ºäº†ä¸€ç§ç”±ç®€å•åˆ°å¤æ‚è®¾è®¡çº§è”åˆ†ç±»å™¨çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯æ·»åŠ ç‰¹å¾æ³•ï¼Œå¯¹äºç¬¬ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œåªç”¨å°‘æ•°å‡ ä¸ªç‰¹å¾ï¼Œä¹‹åçš„æ¯ä¸ªåˆ†ç±»å™¨éƒ½åœ¨ä¸Šä¸€ä¸ªçš„åŸºç¡€ä¸Šæ·»åŠ ç‰¹å¾ï¼Œç›´åˆ°æ»¡è¶³è¯¥çº§çš„è¦æ±‚ã€‚

è®­ç»ƒçº§è”åˆ†ç±»å™¨çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ£€æµ‹çš„æ—¶å€™ï¼Œæ›´åŠ å‡†ç¡®ï¼Œè¿™æ¶‰åŠåˆ°Haaråˆ†ç±»å™¨çš„å¦ä¸€ä¸ªä½“ç³»ï¼Œæ£€æµ‹ä½“ç³»ï¼Œæ£€æµ‹ä½“ç³»æ˜¯ä»¥ç°å®ä¸­çš„ä¸€å¹…å¤§å›¾ç‰‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åå¯¹å›¾ç‰‡ä¸­è¿›è¡Œå¤šåŒºåŸŸï¼Œå¤šå°ºåº¦çš„æ£€æµ‹ï¼Œæ‰€è°“å¤šåŒºåŸŸï¼Œæ˜¯è¦å¯¹å›¾ç‰‡åˆ’åˆ†å¤šå—ï¼Œå¯¹æ¯ä¸ªå—è¿›è¡Œæ£€æµ‹ï¼Œç”±äºè®­ç»ƒçš„æ—¶å€™ç”¨çš„ç…§ç‰‡ä¸€èˆ¬éƒ½æ˜¯20*20å·¦å³çš„å°å›¾ç‰‡ï¼Œæ‰€ä»¥å¯¹äºå¤§çš„äººè„¸ï¼Œè¿˜éœ€è¦è¿›è¡Œå¤šå°ºåº¦çš„æ£€æµ‹ï¼Œå¤šå°ºåº¦æ£€æµ‹æœºåˆ¶ä¸€èˆ¬æœ‰ä¸¤ç§ç­–ç•¥ï¼Œä¸€ç§æ˜¯ä¸æ”¹å˜æœç´¢çª—å£çš„å¤§å°ï¼Œè€Œä¸æ–­ç¼©æ”¾å›¾ç‰‡ï¼Œè¿™ç§æ–¹æ³•æ˜¾ç„¶éœ€è¦å¯¹æ¯ä¸ªç¼©æ”¾åçš„å›¾ç‰‡è¿›è¡ŒåŒºåŸŸç‰¹å¾å€¼çš„è¿ç®—ï¼Œæ•ˆç‡ä¸é«˜ï¼Œè€Œå¦ä¸€ç§æ–¹æ³•ï¼Œæ˜¯ä¸æ–­åˆå§‹åŒ–æœç´¢çª—å£sizeä¸ºè®­ç»ƒæ—¶çš„å›¾ç‰‡å¤§å°ï¼Œä¸æ–­æ‰©å¤§æœç´¢çª—å£ï¼Œè¿›è¡Œæœç´¢ï¼Œè§£å†³äº†ç¬¬ä¸€ç§æ–¹æ³•çš„å¼±åŠ¿ã€‚

6Â Â Â Â Â Â Â Â ç§¯åˆ†å›¾
ç§¯åˆ†å›¾æ˜¯ç”¨æ¥åŠ é€Ÿè®¡ç®—haarç‰¹å¾çš„æ–¹æ³•ã€‚Haarç‰¹å¾çš„è®¡ç®—æ‰€éœ€è¦çš„åŸºæœ¬æ•°æ®å°±æ˜¯åŒºåŸŸå†…åƒç´ çš„å’Œã€‚è€Œä»…ä»…å¯¹äº24*24çš„å›¾ç‰‡æ¥è¯´ï¼Œå®ƒçš„ä¸åŒç±»å‹çš„haarç‰¹å¾æ•°ç›®å°±æœ‰11Wä¸ªï¼ˆå‚è€ƒ[3]ï¼‰ã€‚ä¸ºäº†å¿«é€Ÿçš„è®¡ç®—å‡ºè¿™äº›ç‰¹å¾çš„å€¼ï¼Œå°±æœ‰äº†ç§¯åˆ†å›¾è¡¨ç¤ºå›¾åƒçš„æ–¹æ³•ã€‚

ä»€ä¹ˆæ˜¯ç§¯åˆ†å›¾ï¼Ÿå¯¹äºä¸å›¾åƒè¾¹ç•Œå¹³è¡Œçš„haarç‰¹å¾æ¥è¯´ï¼Œç§¯åˆ†å›¾å°±æ˜¯ä¸å›¾åƒå¤§å°ä¸€æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚è¯¥æ•°ç»„ä¸­ï¼Œ(x,y)ä½ç½®çš„å€¼æ˜¯åŸå§‹å›¾åƒä¸­ä»(0,0)åˆ°(x,y)å¤„çš„åƒç´ å€¼çš„å’Œã€‚å¯¹äº45åº¦åå‘çš„haarç‰¹å¾æ¥è¯´ï¼Œä¹Ÿç±»ä¼¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š



å¯¹äºaã€cå›¾æ‰€ç¤ºçš„haarç‰¹å¾ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š







å…¶ä¸­ï¼ŒSATå³ä¸ºç§¯åˆ†å›¾ä¸­çš„å€¼ï¼ŒRecSumå³ä¸º(x,y)å¤„çš„é•¿å®½ä¸º(w,h)çš„åŒºåŸŸçš„å’Œã€‚æœ‰äº†RecSumåï¼Œå°±å¯ä»¥è®¡ç®—haarç‰¹å¾äº†ã€‚

ç›¸ä¼¼çš„ï¼Œbï¼Œdå›¾æ‰€ç¤ºçš„haarç‰¹å¾è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š







æ„ä¹‰ç±»ä¼¼ï¼Œä¸ä¸€ä¸€è§£é‡Šäº†ã€‚

ç§¯åˆ†å›¾çš„å¥½å¤„åœ¨äºï¼Œåªå¯¹å›¾ç‰‡è¿›è¡Œä¸€æ¬¡ç´¯è®¡è®¡ç®—ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¡ç®—å‡ºhaarç‰¹å¾å€¼äº†ã€‚

7Â Â Â Â Â Â Â Â æ€»ç»“
åŸºäºHaarç‰¹å¾çš„Adaboostçº§è”åˆ†ç±»å™¨ï¼Œåœ¨äººè„¸çš„è¯†åˆ«æ•ˆæœä¸Šå¹¶æ²¡æœ‰æ¯”å…¶ä»–ç®—æ³•é«˜ï¼Œå…¶äº®ç‚¹åœ¨äºæ£€æµ‹é€Ÿåº¦ã€‚è€Œé€Ÿåº¦çš„æå‡ï¼Œæœ‰å¦‚ä¸‹å‡ æ–¹é¢çš„å› ç´ ã€‚ç¬¬ä¸€ï¼šä½¿ç”¨çš„ç‰¹å¾ç®€å•ï¼Œhaarç‰¹å¾åªéœ€è®¡ç®—åƒç´ çš„å’Œå°±å¯ä»¥äº†ã€‚ç¬¬äºŒï¼šå³ä¾¿æ˜¯å¦‚æ­¤ç®€å•çš„ç‰¹å¾ï¼Œè¿˜æ·»åŠ äº†ç§¯åˆ†å›¾è¿›è¡ŒåŠ é€Ÿã€‚ç¬¬ä¸‰ï¼Œçº§è”åˆ†ç±»å™¨çš„è®¾å®šï¼Œä½¿å¾—å¤§é‡çš„æ²¡æœ‰äººè„¸çš„å­çª—å£è¢«æŠ›å¼ƒã€‚

å‚è€ƒæ–‡çŒ®
[1]. Viola P, Jones M. Rapid object detection using a boosted cascade of simple features[C]//Computer Vision and Pattern Recognition, 2001. CVPR 2001. Proceedings of the 2001 IEEE Computer Society Conference on. IEEE, 2001, 1: I-511-I-518 vol. 1.
[2]. Lienhart R, Maydt J. An extended set of haar-like features for rapid object detection[C]//Image Processing. 2002. Proceedings. 2002 International Conference on. IEEE, 2002, 1: I-900-I-903 vol. 1.
[3]. Lienhart R, Kuranov A, Pisarevsky V. Empirical analysis of detection cascades of boosted classifiers for rapid object detection[M]//Pattern Recognition. Springer Berlin Heidelberg, 2003: 297-304.
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œå¼ é›¨çŸ³ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚
åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/stdcoutzyx/java/article/details/34842233





```python

'''
ä»¥ Haar ç‰¹å¾åˆ†ç±»å™¨ä¸ºåŸºç¡€çš„é¢éƒ¨æ£€æµ‹æŠ€æœ¯
å°†é¢éƒ¨æ£€æµ‹æ‰©å±•åˆ°çœ¼éƒ¨æ£€æµ‹ç­‰ã€‚

ä»¥ Haar ç‰¹å¾åˆ†ç±»å™¨ä¸ºåŸºç¡€çš„å¯¹ æ£€æµ‹æŠ€æœ¯æ˜¯ä¸€ç§ å¸¸æœ‰æ•ˆçš„å¯¹ æ£€æµ‹ æŠ€æœ¯ 2001 å¹´ Paul_Viola å’Œ Michael_Jones æå‡º ã€‚å®ƒæ˜¯åŸºäºæœºå™¨å­¦ä¹ çš„    ä½¿ç”¨å¤§ çš„æ­£ æ ·æœ¬å›¾åƒ ç»ƒå¾—åˆ°ä¸€ä¸ª cascade_function æœ€åå†ç”¨å®ƒ æ¥åšå¯¹ æ£€æµ‹ã€‚
ç°åœ¨æˆ‘ä»¬æ¥å­¦ä¹   æ£€æµ‹ã€‚å¼€å§‹æ—¶ ç®—æ³•  å¤§ çš„æ­£æ ·æœ¬å›¾åƒ   å›¾ åƒ å’Œ æ ·æœ¬å›¾åƒ ä¸å«  çš„å›¾åƒ æ¥ ç»ƒåˆ†ç±»å™¨ã€‚æˆ‘ä»¬  ä»å…¶ä¸­æå–ç‰¹ å¾ã€‚ä¸‹å›¾ä¸­çš„ Haar ç‰¹å¾ä¼š ä½¿ç”¨ã€‚å®ƒä»¬å°±åƒæˆ‘ä»¬çš„å·ç§¯æ ¸ã€‚æ¯ä¸€ä¸ªç‰¹å¾æ˜¯ä¸€ ä¸ªå€¼  ä¸ªå€¼ç­‰äº è‰²çŸ©å½¢ä¸­çš„åƒç´ å€¼ä¹‹åå‡å»ç™½è‰²çŸ©å½¢ä¸­çš„åƒç´ å€¼ä¹‹å’Œã€‚

 é‚£ä¹ˆæˆ‘ä»¬æ€æ ·ä»è¶…è¿‡160000+ ä¸ªç‰¹å¾ä¸­ å‡ºæœ€å¥½çš„ç‰¹å¾å‘¢ ï¼Ÿ
 ä½¿ç”¨ Adaboostã€‚

OpenCV è‡ªå¸¦äº†è®­ç»ƒå™¨å’Œæ£€æµ‹å™¨ã€‚å¦‚æœä½ æƒ³è‡ªå·±è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨æ¥æ£€æµ‹ æ±½è½¦é£æœºç­‰çš„
å¯ä»¥ä½¿ç”¨ OpenCV æ„å»ºã€‚
Cascade Classifier Training :http://docs.opencv.org/2.4/doc/user_guide/ug_traincascade.html


'''

import numpy as np
import cv2

# è¿è¡Œä¹‹å‰ï¼Œæ£€æŸ¥cascadeæ–‡ä»¶è·¯å¾„æ˜¯å¦åœ¨ä½ çš„ç”µè„‘ä¸Š
face_cascade = cv2.CascadeClassifier('/usr/local/share/OpenCV/haarcascades/haarcascade_frontalface_default.xml')
eye_cascade = cv2.CascadeClassifier('/usr/local/share/OpenCV/haarcascades/haarcascade_eye.xml')

# img = cv2.imread('../data/sachin.jpg')
# img = cv2.imread('../data/kongjie_hezhao.jpg')
img = cv2.imread('../data/airline-stewardess-bikini.jpg')
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
# cv2.imshow('gray', gray)


# Detects objects of different sizes in the input image.
# The detected objects are returned as a list of rectangles.
# cv2.CascadeClassifier.detectMultiScale(image, scaleFactor, minNeighbors, flags, minSize, maxSize)
# scaleFactor â€“ Parameter specifying how much the image size is reduced at each image
# scale.
# minNeighbors â€“ Parameter specifying how many neighbors each candidate rectangle should
# have to retain it.
# minSize â€“ Minimum possible object size. Objects smaller than that are ignored.
# maxSize â€“ Maximum possible object size. Objects larger than that are ignored.
# faces = face_cascade.detectMultiScale(gray, 1.3, 5)
faces = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5, minSize=(30, 30), flags=cv2.CASCADE_SCALE_IMAGE)#æ”¹è¿›
print("Detected ", len(faces), " face")

for (x, y, w, h) in faces:
    img = cv2.rectangle(img, (x, y), (x + w, y + h), (255, 0, 0), 2)
    roi_gray = gray[y:y + h, x:x + w]
    roi_color = img[y:y + h, x:x + w]

    eyes = eye_cascade.detectMultiScale(roi_gray)
    for (ex, ey, ew, eh) in eyes:
        cv2.rectangle(roi_color, (ex, ey), (ex + ew, ey + eh), (0, 255, 0), 2)

cv2.imshow('img', img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```


https://zhuanlan.zhihu.com/p/45625323
